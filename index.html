<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Apple the Parrot - Crypto Carnival</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #e0f7fa;
      padding: 20px;
    }
    h1 {
      color: #00796b;
    }
    img {
      width: 200px;
      height: auto;
      margin: 20px 0;
    }
    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 18px;
      background-color: #00796b;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    button:hover {
      background-color: #004d40;
    }
    #progress {
      margin-top: 20px;
      font-size: 18px;
      color: #004d40;
    }
    #message {
      margin-top: 20px;
      font-size: 20px;
      color: #d32f2f;
    }
  </style>
</head>
<body>

  <h1>Welcome to Apple the Parrot!</h1>
  
  <div id="game-area">
    <button id="collect-egg-btn">Collect Egg</button>
    <div id="egg-stage" style="display:none;">
      <img id="egg-image" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Egg.svg/1200px-Egg.svg.png" alt="Egg">
      <p>Daily Action: <button id="give-light-btn">Give Light</button></p>
      <div id="egg-progress"></div>
    </div>

    <div id="hatch-stage" style="display:none;">
      <img id="parrot-image" src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Green_parrot_cartoon.png" alt="Parrot">
      <p>Daily Action: <button id="feed-apple-btn">Feed Apple</button></p>
      <div id="parrot-progress"></div>
    </div>

    <div id="reward-stage" style="display:none;">
      <p id="happiness-status"></p>
      <button id="claim-reward-btn">Claim Reward</button>
    </div>

    <div id="progress"></div>
    <div id="message"></div>
  </div>

  <script>
    // Game Variables
    const collectEggBtn = document.getElementById('collect-egg-btn');
    const giveLightBtn = document.getElementById('give-light-btn');
    const feedAppleBtn = document.getElementById('feed-apple-btn');
    const claimRewardBtn = document.getElementById('claim-reward-btn');
    const eggStage = document.getElementById('egg-stage');
    const hatchStage = document.getElementById('hatch-stage');
    const rewardStage = document.getElementById('reward-stage');
    const eggProgress = document.getElementById('egg-progress');
    const parrotProgress = document.getElementById('parrot-progress');
    const happinessStatus = document.getElementById('happiness-status');
    const message = document.getElementById('message');

    // Load Game State
    let state = JSON.parse(localStorage.getItem('appleGameState')) || {
      eggCollected: false,
      eggStartDate: null,
      eggCareDays: 0,
      eggHatched: false,
      parrotStartDate: null,
      parrotCareDays: 0,
      rewardClaimed: false
    };

    function saveState() {
      localStorage.setItem('appleGameState', JSON.stringify(state));
    }

    function daysSince(dateString) {
      const then = new Date(dateString);
      const now = new Date();
      const diffTime = now - then;
      return Math.floor(diffTime / (1000 * 60 * 60 * 24));
    }

    function updateGame() {
      if (!state.eggCollected) {
        collectEggBtn.style.display = 'inline-block';
        eggStage.style.display = 'none';
        hatchStage.style.display = 'none';
        rewardStage.style.display = 'none';
      } else if (!state.eggHatched) {
        collectEggBtn.style.display = 'none';
        eggStage.style.display = 'block';
        hatchStage.style.display = 'none';
        rewardStage.style.display = 'none';
        eggProgress.innerText = `Egg Care: ${state.eggCareDays}/3 days`;
      } else if (!state.rewardClaimed) {
        collectEggBtn.style.display = 'none';
        eggStage.style.display = 'none';
        hatchStage.style.display = 'block';
        rewardStage.style.display = 'none';
        parrotProgress.innerText = `Feeding Progress: ${state.parrotCareDays}/3 days`;
      } else {
        collectEggBtn.style.display = 'none';
        eggStage.style.display = 'none';
        hatchStage.style.display = 'none';
        rewardStage.style.display = 'block';
      }
    }

    collectEggBtn.addEventListener('click', () => {
      state.eggCollected = true;
      state.eggStartDate = new Date().toISOString();
      state.eggCareDays = 0;
      saveState();
      updateGame();
    });

    giveLightBtn.addEventListener('click', () => {
      if (daysSince(state.eggStartDate) >= state.eggCareDays) {
        state.eggCareDays++;
        saveState();
        eggProgress.innerText = `Egg Care: ${state.eggCareDays}/3 days`;
        message.innerText = "You gave light to the egg!";
        if (state.eggCareDays >= 3) {
          state.eggHatched = true;
          state.parrotStartDate = new Date().toISOString();
          state.parrotCareDays = 0;
          saveState();
          updateGame();
          message.innerText = "Your egg hatched! Meet Apple the Parrot!";
        }
      } else {
        message.innerText = "Come back tomorrow to give more light!";
      }
    });

    feedAppleBtn.addEventListener('click', () => {
      if (daysSince(state.parrotStartDate) >= state.parrotCareDays) {
        state.parrotCareDays++;
        saveState();
        parrotProgress.innerText = `Feeding Progress: ${state.parrotCareDays}/3 days`;
        message.innerText = "You fed Apple!";
        if (state.parrotCareDays >= 3) {
          rewardStage.style.display = 'block';
          hatchStage.style.display = 'none';
          if (state.parrotCareDays === 3) {
            happinessStatus.innerText = "Apple is Happy! Big Bonus Awaits!";
          } else {
            happinessStatus.innerText = "Apple is Sad. Small Bonus Awaits.";
          }
        }
      } else {
        message.innerText = "Come back tomorrow to feed Apple!";
      }
    });

    claimRewardBtn.addEventListener('click', () => {
      state.rewardClaimed = true;
      saveState();
      updateGame();
      if (state.parrotCareDays === 3) {
        message.innerText = "You received a BIG bonus! Thank you for taking care of Apple!";
      } else {
        message.innerText = "You received a SMALL bonus! Try to care more next time!";
      }
    });

    updateGame();
  </script>

</body>
</html>
